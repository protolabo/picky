<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Picky</title>

  <!-- Handsontable CSS LOCAL -->
  <link rel="stylesheet" href="libs/handsontable.min.css">

  <!-- Ton CSS -->
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <div id="drop-zone" class="drop-zone">
      <div class="drop-zone-text">
        Glissez et déposez votre image ici<br>ou<br>
        <button id="upload-btn">Choisir un fichier</button>
        <input type="file" id="file-input" accept="image/*" hidden>
        
      </div>
    </div>
    
    <div id="canvas-wrapper" class="hidden">
      <div class="edit-buttons " >
        <button id="addZoneBtn" class="export-btn"> Ajouter une zone</button>
        <button id="saveZonesBtn" class="export-btn"> Valider les zones</button>
      </div>
      <p></p>

      <canvas id="zone-canvas">_</canvas>

      <div class="edit-buttons " id="edit-buttons">
        <button id="new-add-row" class="export-btn">➕ Ligne</button>
        <button id="new-add-col" class="export-btn">➕ Colonne</button>
        <button id="remove-row" class="export-btn">Supprimer une ligne</button>
        <button id="remove-col" class="export-btn">Supprimer une colonne</button>
        <button id="reset-table" class="export-btn">Réinitialiser le tableau</button>
        
      </div>

    </div>

    <div id="loading" class="loading hidden">Traitement en cours...</div>
    <div id="error" class="error hidden"></div>
    
    <div id="open-window-div" class="open-window hidden">
      <button id="open-window" class="window-btn">Ouvrir le tableau en plein écran</button>
    </div>

    
    <div id="result" class="result hidden">
      <div id="table-help" style="display: flex; align-items: center; gap: 5px; margin-bottom: 8px;">
        <span style="font-weight: 600;"></span>
        <span class="info-icon" title="Vous pouvez :
      - Ajouter/supprimer une colonne avec un clic droit
      - Fusionner des cellules en les sélectionnant puis clic droit
      - Utiliser le clic droit pour annuler/refaire (Undo/Redo)">
          ℹ️
        </span>
      </div>
      <div class="table-container"></div>

      <div id="export-buttons" class="export-buttons hidden">
        <button class="export-btn" id="export-csv">Exporter en CSV</button>
        <button class="export-btn" id="export-json">Exporter en JSON</button>
        <button class="export-btn" id="export-xml">Exporter en XML</button>
        <button class="export-btn" id="export-xlsx">Exporter en Excel</button>
      </div>

      
    </div>
  </div>
  
  <div id="export-preview-section" class="hidden">
    <div id="export-switch-buttons-json" class="hidden" style="margin-bottom: 10px;  gap: 10px;">
      <button id="raw-export-json" class="export-btn">Export brut</button>
      <button id="switch-to-row" class="export-btn">Exporter par ligne</button>
      <button id="switch-to-column" class="export-btn">Exporter par colonne</button>
    </div>
    <div id="export-switch-buttons-xml" class="hidden" style="margin-bottom: 10px;  gap: 10px;">
      <button id="raw-export-xml" class="export-btn">Export brut</button>
    </div>
  <h4>Aperçu </h4>
  <pre id="export-preview-content"  ></pre>
  <div style="margin-top: 5px;">
    
    <button id="confirm-export-btn" class="export-btn">Valider l'export</button>
    <button id="cancel-export-btn" class="export-btn" >Annuler</button>
  </div>
</div>

  <!-- Handsontable JS LOCAL -->
  <script src="libs/handsontable.min.js"></script>
  <script src="libs/xlsx.full.min.js"></script>
  <!-- Ton JS -->
  <script src="popup.js"></script>
  
  <script src="zone_editor.js"></script>
</body>
</html>
